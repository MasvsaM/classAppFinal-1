"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6051],{6051:(k,f,r)=>{r.r(f),r.d(f,{HomePageModule:()=>A});var d=r(6814),_=r(95),a=r(9004),g=r(4934),u=r(5861),t=r(5879),h=r(6602),v=r(9992),x=r(5386),C=r(74);function P(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"ion-item-options",12)(1,"ion-item-option",13),t.NdJ("click",function(){t.CHM(n);const o=t.oxw().$implicit,c=t.oxw(2);return t.KtG(c.addUpdateCurso(o))}),t._UZ(2,"ion-icon",14),t.qZA(),t.TgZ(3,"ion-item-option",15),t.NdJ("click",function(){t.CHM(n);const o=t.oxw().$implicit,c=t.oxw(2);return t.KtG(c.confirmDeleteCurso(o))}),t._UZ(4,"ion-icon",16),t.qZA()()}}function Z(e,s){if(1&e&&(t.TgZ(0,"ion-item-sliding",5)(1,"ion-item")(2,"ion-avatar",6),t._UZ(3,"img",7),t.qZA(),t.TgZ(4,"ion-label")(5,"div",8),t._uU(6),t.qZA(),t.TgZ(7,"div",9)(8,"strong"),t._uU(9,"Seccion:"),t.qZA(),t._uU(10),t._UZ(11,"br"),t.qZA(),t.TgZ(12,"div",9)(13,"strong"),t._uU(14,"Sala:"),t.qZA(),t._uU(15),t.qZA()(),t.TgZ(16,"ion-button",10),t._uU(17," Ver Detalle "),t.qZA()(),t.YNc(18,P,5,0,"ion-item-options",11),t.qZA()),2&e){const n=s.$implicit,i=t.oxw(2);t.xp6(3),t.Q6J("src",n.image,t.LSH),t.xp6(3),t.Oqu(n.name),t.xp6(4),t.hij("",n.seccion," "),t.xp6(5),t.hij("",n.sala," "),t.xp6(3),t.Q6J("ngIf","admin"===i.rol)}}function M(e,s){if(1&e&&(t.TgZ(0,"ion-list")(1,"ion-list-header")(2,"ion-label"),t._uU(3,"Lista de Cursos"),t.qZA()(),t.YNc(4,Z,19,5,"ion-item-sliding",4),t.qZA()),2&e){const n=t.oxw();t.xp6(4),t.Q6J("ngForOf",n.cursos)}}function b(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"ion-button",17),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.addUpdateCurso())}),t._uU(1," Registrar Cursos "),t._UZ(2,"ion-icon",18),t.qZA()}}const H=function(){return["/sign-up"]};function U(e,s){1&e&&(t.TgZ(0,"ion-button",19),t._uU(1," Registrar Usuario "),t._UZ(2,"ion-icon",20),t.qZA()),2&e&&t.Q6J("routerLink",t.DdM(1,H))}const S=[{path:"",component:(()=>{var e;class s{constructor(){this.firebaseauthSvc=(0,t.f3M)(v.s),this.utilsSvc=(0,t.f3M)(x.F),this.cursos=[],this.users=[],this.rol=null,this.loading=!1}user(){return this.utilsSvc.getFromlocalStorage("user")}ionViewDidEnter(){this.getCursos()}ngOnInit(){this.firebaseauthSvc.stateUser().subscribe(i=>{i?(this.getUserInf(i.uid),this.getCursos()):this.cursos=[]})}getUserInf(i){this.firebaseauthSvc.getDocument(`users/${i}`).then(c=>{console.log("datos ->",c),c&&(this.rol=c.profile)})}getCursos(){this.loading=!0,this.firebaseauthSvc.stateUser().subscribe(o=>{o&&this.firebaseauthSvc.getCollectionData("cursos").subscribe(c=>{this.cursos=c.filter(l=>!(l.profesor.uid!=o.uid&&!l.alumnos.some(p=>p.uid==o.uid)&&"admin"!=this.rol)),this.loading=!1})})}addUpdateCurso(i){var o=this;return(0,u.Z)(function*(){(yield o.utilsSvc.presentModal({component:h.j,cssClass:"add-update-modal",componentProps:{curso:i}}))&&o.getCursos()})()}confirmDeleteCurso(i){var o=this;return(0,u.Z)(function*(){o.utilsSvc.presentAlert({header:"Eliminar Curso",message:"\xbfQuieres eliminar este curso?",mode:"ios",buttons:[{text:"Cancelar"},{text:"S\xed, eliminar",handler:()=>{o.deleteCurso(i)}}]})})()}deleteCurso(i){var o=this;return(0,u.Z)(function*(){let c=`cursos/${i.id}`;const l=yield o.utilsSvc.loading();yield l.present();let p=yield o.firebaseauthSvc.getFilePath(i.image);yield o.firebaseauthSvc.deleteFile(p),o.firebaseauthSvc.deleteDocument(c).then(function(){var m=(0,u.Z)(function*(y){o.cursos=o.cursos.filter(I=>I.id!==i.id),o.utilsSvc.presentToast({message:"Curso eliminado exitosamente",duration:1500,color:"success",position:"middle",icon:"checkmark-circle-outline"})});return function(y){return m.apply(this,arguments)}}()).catch(m=>{console.log(m),o.utilsSvc.presentToast({message:m.message,duration:2500,color:"primary",position:"middle",icon:"alert-circle-outline"})}).finally(()=>{l.dismiss()})})()}verDetalle(i){this.utilsSvc.routerlink("/detalle-curso")}}return(e=s).\u0275fac=function(i){return new(i||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-home"]],decls:5,vars:4,consts:[["title","Inicio",3,"showMenu"],[4,"ngIf"],["class","ion-margin-top","expand","block","mode","ios","fill","outline",3,"click",4,"ngIf"],["class","ion-margin-top","expand","block","mode","ios","fill","outline",3,"routerLink",4,"ngIf"],["class","curso-item",4,"ngFor","ngForOf"],[1,"curso-item"],["slot","start"],[3,"src"],[1,"name"],[1,"data"],["routerLink","/detalle-curso","size","small","mode","ios","fill","outline"],["detail","true",4,"ngIf"],["detail","true"],[3,"click"],["name","create-outline",1,"option-btn"],["color","danger",3,"click"],["name","trash-outline",1,"option-btn"],["expand","block","mode","ios","fill","outline",1,"ion-margin-top",3,"click"],["slot","start","name","desktop-outline"],["expand","block","mode","ios","fill","outline",1,"ion-margin-top",3,"routerLink"],["slot","end","name","person-add-outline"]],template:function(i,o){1&i&&(t._UZ(0,"app-header",0),t.TgZ(1,"ion-content"),t.YNc(2,M,5,1,"ion-list",1),t.YNc(3,b,3,0,"ion-button",2),t.YNc(4,U,3,2,"ion-button",3),t.qZA()),2&i&&(t.Q6J("showMenu",!0),t.xp6(2),t.Q6J("ngIf",!o.loading),t.xp6(1),t.Q6J("ngIf","admin"===o.rol),t.xp6(1),t.Q6J("ngIf","admin"===o.rol))},dependencies:[d.sg,d.O5,a.BJ,a.YG,a.W2,a.gu,a.Ie,a.u8,a.IK,a.td,a.Q$,a.q_,a.yh,a.YI,g.rH,C.G],styles:[".curso-item[_ngcontent-%COMP%]{--padding-top: 20px}.curso-item[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{width:75px;height:80px;--border-radius: 10px}.curso-item[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:600;padding-bottom:5px}.curso-item[_ngcontent-%COMP%]   .data[_ngcontent-%COMP%]{font-size:13px}.curso-item[_ngcontent-%COMP%]   .data[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:700}.curso-item[_ngcontent-%COMP%]   .option-btn[_ngcontent-%COMP%]{font-size:27px}.curso-item[_ngcontent-%COMP%]   ion-chip[_ngcontent-%COMP%]{font-size:14px;border-radius:10px;margin-left:0}ion-list-header[_ngcontent-%COMP%]{font-size:25px;margin-top:5px;font-weight:700}"]}),s})()}];let T=(()=>{var e;class s{}return(e=s).\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[g.Bz.forChild(S),g.Bz]}),s})();var O=r(8554);let A=(()=>{var e;class s{}return(e=s).\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[d.ez,_.u5,a.Pc,T,O.m]}),s})()}}]);